{
	"document_title": "FortiMail's SaltHash vulnerable to extension attacks",
	"document_type": "Fortinet PSIRT Advisories",
	"documentpublisher": {
		"type": "Vendor",
		"contact_details": "\n            Fortinet PSIRT Contact:\n            Website: https://fortiguard.fortinet.com/faq/psirt-contact\n        "
	},
	"documenttracking": {
		"identification": {
			"id": "FG-IR-21-027"
		},
		"status": "Final",
		"version": "1",
		"revisionhistory": {
			"revision": {
				"number": "1",
				"date": "2021-07-07T00:00:00",
				"description": "Current version"
			}
		},
		"initial_release_date": "2021-07-07T00:00:00",
		"current_release_date": "2021-07-07T00:00:00"
	},
	"documentnotes": {
		"note": [
			{
				"text": "\n            A missing cryptographic step in the implementation of the hash digest algorithm in FortiMail may allow an unauthenticated attacker to tamper with signed URLs by appending further data which allows bypass of signature verification.\n        ",
				"title": "Summary",
				"type": "Summary",
				"ordinal": "1"
			},
			{
				"text": "\n            Improper access control\n        ",
				"title": "Impact",
				"type": "General",
				"ordinal": "2"
			},
			{
				"text": "\n            FortiMail 6.4.4 and below,FortiMail 6.2.6 and below.\n        ",
				"title": "Affected Products",
				"type": "General",
				"ordinal": "3"
			},
			{
				"text": "\n            Upgrade to FortiMail version 7.0.0.Upgrade to FortiMail version 6.4.5.\n        ",
				"title": "Solutions",
				"type": "General",
				"ordinal": "4"
			}
		]
	},
	"document_references": {},
	"acknowledgments": {
		"acknowledgment": [
			{
				"description": "Internally discovered and reported by Giuseppe Cocomazzi of the Fortinet PSIRT Team."
			}
		]
	},
	"vulnerability": {
		"ordinal": "1",
		"title": "FortiMail's SaltHash vulnerable to extension attacks",
		"references": {
			"type": "Self",
			"reference": [
				{
					"url": "https://fortiguard.fortinet.com/psirt/FG-IR-21-027",
					"description": "FortiMail's SaltHash vulnerable to extension attacks"
				}
			]
		},
		"cve": [
			"CVE-2021-24020"
		],
		"product_statuses": {
			"status": {
				"type": "Known Affected",
				"product_id": [
					"FortiMail-6.4.4",
					"FortiMail-6.4.3",
					"FortiMail-6.4.2",
					"FortiMail-6.4.1",
					"FortiMail-6.4.0",
					"FortiMail-6.2.9",
					"FortiMail-6.2.8",
					"FortiMail-6.2.7",
					"FortiMail-6.2.6",
					"FortiMail-6.2.5",
					"FortiMail-6.2.4",
					"FortiMail-6.2.3",
					"FortiMail-6.2.2",
					"FortiMail-6.2.1",
					"FortiMail-6.2.0"
				]
			}
		},
		"cvss_scoresets": {
			"scoreset_v3": {
				"base_score_v3": "6.9",
				"vector_v3": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:U/RC:C"
			}
		}
	},
	"product_tree": {
		"branch": {
			"name": "Fortinet",
			"type": "Vendor",
			"branch": [
				{
					"name": "FortiMail",
					"type": "Product Name",
					"branch": [
						{
							"name": "6.4.4",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.4.4",
								"product_id": "FortiMail-6.4.4"
							}
						},
						{
							"name": "6.4.3",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.4.3",
								"product_id": "FortiMail-6.4.3"
							}
						},
						{
							"name": "6.4.2",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.4.2",
								"product_id": "FortiMail-6.4.2"
							}
						},
						{
							"name": "6.4.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.4.1",
								"product_id": "FortiMail-6.4.1"
							}
						},
						{
							"name": "6.4.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.4.0",
								"product_id": "FortiMail-6.4.0"
							}
						},
						{
							"name": "6.2.9",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.2.9",
								"product_id": "FortiMail-6.2.9"
							}
						},
						{
							"name": "6.2.8",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.2.8",
								"product_id": "FortiMail-6.2.8"
							}
						},
						{
							"name": "6.2.7",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.2.7",
								"product_id": "FortiMail-6.2.7"
							}
						},
						{
							"name": "6.2.6",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.2.6",
								"product_id": "FortiMail-6.2.6"
							}
						},
						{
							"name": "6.2.5",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.2.5",
								"product_id": "FortiMail-6.2.5"
							}
						},
						{
							"name": "6.2.4",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.2.4",
								"product_id": "FortiMail-6.2.4"
							}
						},
						{
							"name": "6.2.3",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.2.3",
								"product_id": "FortiMail-6.2.3"
							}
						},
						{
							"name": "6.2.2",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.2.2",
								"product_id": "FortiMail-6.2.2"
							}
						},
						{
							"name": "6.2.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.2.1",
								"product_id": "FortiMail-6.2.1"
							}
						},
						{
							"name": "6.2.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiMail 6.2.0",
								"product_id": "FortiMail-6.2.0"
							}
						}
					]
				}
			]
		}
	}
}
