{
	"document_title": "XSS against CSRF failure page due referer not been XSS escaped",
	"document_type": "Fortinet PSIRT Advisories",
	"documentpublisher": {
		"type": "Vendor",
		"contact_details": "\n            Fortinet PSIRT Contact:\n            Website: https://fortiguard.fortinet.com/faq/psirt-contact\n        "
	},
	"documenttracking": {
		"identification": {
			"id": "FG-IR-18-059"
		},
		"status": "Final",
		"version": "1",
		"revisionhistory": {
			"revision": {
				"number": "1",
				"date": "2018-05-29T00:00:00",
				"description": "Current version"
			}
		},
		"initial_release_date": "2018-05-29T00:00:00",
		"current_release_date": "2018-05-29T00:00:00"
	},
	"documentnotes": {
		"note": [
			{
				"text": "\n            On FortiAuthenticator, a HTML page is returned to the user when the CSRF validation fails on referer mismatch. This page displays the faulty referer without sanitizing it. Therefore, in an attack scenario where the referer could be manipulated, the attacker could inject malicious scripts in the aforementioned HTML-page.\n        ",
				"title": "Summary",
				"type": "Summary",
				"ordinal": "1"
			},
			{
				"text": "\n            Execute unauthorized code or commands\n        ",
				"title": "Impact",
				"type": "General",
				"ordinal": "2"
			},
			{
				"text": "\n            FortAuthenticator below 5.3.0 versions.\n        ",
				"title": "Affected Products",
				"type": "General",
				"ordinal": "3"
			},
			{
				"text": "\n            Upgrade to FortiAuthenticator 5.3.0 or above.\n        ",
				"title": "Solutions",
				"type": "General",
				"ordinal": "4"
			}
		]
	},
	"document_references": {},
	"acknowledgments": {
		"acknowledgment": [
			{
				"description": "Fortinet is pleased to thank Arun Narayanan from Applied-Risk reporting this vulnerability under responsible disclosure."
			}
		]
	},
	"vulnerability": {
		"ordinal": "1",
		"title": "XSS against CSRF failure page due referer not been XSS escaped",
		"references": {
			"type": "Self",
			"reference": [
				{
					"url": "https://fortiguard.fortinet.com/psirt/FG-IR-18-059",
					"description": "XSS against CSRF failure page due referer not been XSS escaped"
				}
			]
		},
		"cve": [
			"CVE-2018-9186"
		],
		"product_statuses": {
			"status": {
				"type": "Known Affected",
				"product_id": [
					"FortiAuthenticator-5.2.2",
					"FortiAuthenticator-5.2.1",
					"FortiAuthenticator-5.2.0",
					"FortiAuthenticator-5.1.2",
					"FortiAuthenticator-5.1.1",
					"FortiAuthenticator-5.1.0",
					"FortiAuthenticator-5.0.0",
					"FortiAuthenticator-4.3.4",
					"FortiAuthenticator-4.3.2",
					"FortiAuthenticator-4.3.1",
					"FortiAuthenticator-4.3.0",
					"FortiAuthenticator-4.2.1",
					"FortiAuthenticator-4.2.0",
					"FortiAuthenticator-4.1.2",
					"FortiAuthenticator-4.1.1",
					"FortiAuthenticator-4.1.0",
					"FortiAuthenticator-4.0.1",
					"FortiAuthenticator-4.0.0"
				]
			}
		},
		"cvss_scoresets": {
			"scoreset_v3": {
				"base_score_v3": "3.4",
				"vector_v3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:X/RC:X"
			}
		}
	},
	"product_tree": {
		"branch": {
			"name": "Fortinet",
			"type": "Vendor",
			"branch": [
				{
					"name": "FortiAuthenticator",
					"type": "Product Name",
					"branch": [
						{
							"name": "5.2.2",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 5.2.2",
								"product_id": "FortiAuthenticator-5.2.2"
							}
						},
						{
							"name": "5.2.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 5.2.1",
								"product_id": "FortiAuthenticator-5.2.1"
							}
						},
						{
							"name": "5.2.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 5.2.0",
								"product_id": "FortiAuthenticator-5.2.0"
							}
						},
						{
							"name": "5.1.2",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 5.1.2",
								"product_id": "FortiAuthenticator-5.1.2"
							}
						},
						{
							"name": "5.1.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 5.1.1",
								"product_id": "FortiAuthenticator-5.1.1"
							}
						},
						{
							"name": "5.1.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 5.1.0",
								"product_id": "FortiAuthenticator-5.1.0"
							}
						},
						{
							"name": "5.0.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 5.0.0",
								"product_id": "FortiAuthenticator-5.0.0"
							}
						},
						{
							"name": "4.3.4",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 4.3.4",
								"product_id": "FortiAuthenticator-4.3.4"
							}
						},
						{
							"name": "4.3.2",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 4.3.2",
								"product_id": "FortiAuthenticator-4.3.2"
							}
						},
						{
							"name": "4.3.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 4.3.1",
								"product_id": "FortiAuthenticator-4.3.1"
							}
						},
						{
							"name": "4.3.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 4.3.0",
								"product_id": "FortiAuthenticator-4.3.0"
							}
						},
						{
							"name": "4.2.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 4.2.1",
								"product_id": "FortiAuthenticator-4.2.1"
							}
						},
						{
							"name": "4.2.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 4.2.0",
								"product_id": "FortiAuthenticator-4.2.0"
							}
						},
						{
							"name": "4.1.2",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 4.1.2",
								"product_id": "FortiAuthenticator-4.1.2"
							}
						},
						{
							"name": "4.1.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 4.1.1",
								"product_id": "FortiAuthenticator-4.1.1"
							}
						},
						{
							"name": "4.1.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 4.1.0",
								"product_id": "FortiAuthenticator-4.1.0"
							}
						},
						{
							"name": "4.0.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 4.0.1",
								"product_id": "FortiAuthenticator-4.0.1"
							}
						},
						{
							"name": "4.0.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiAuthenticator 4.0.0",
								"product_id": "FortiAuthenticator-4.0.0"
							}
						}
					]
				}
			]
		}
	}
}
