{
	"document_title": "FortiOS - IPS Engine evasion using custom TCP flags",
	"document_type": "Fortinet PSIRT Advisories",
	"documentpublisher": {
		"type": "Vendor",
		"contact_details": "\n            Fortinet PSIRT Contact:\n            Website: https://fortiguard.fortinet.com/faq/psirt-contact\n        "
	},
	"documenttracking": {
		"identification": {
			"id": "FG-IR-23-090"
		},
		"status": "Final",
		"version": "1",
		"revisionhistory": {
			"revision": {
				"number": "1",
				"date": "2023-10-10T00:00:00",
				"description": "Current version"
			}
		},
		"initial_release_date": "2023-10-10T00:00:00",
		"current_release_date": "2023-10-10T00:00:00"
	},
	"documentnotes": {
		"note": [
			{
				"text": "\n            An interpretation conflict vulnerability [CWE-436] in FortiOS IPS Engine may allow an unauthenticated remote attacker to evade NGFW policies or IPS Engine protection via crafted TCP packets.\n        ",
				"title": "Summary",
				"type": "Summary",
				"ordinal": "1"
			},
			{
				"text": "\n            None\n        ",
				"title": "Description",
				"type": "General",
				"ordinal": "2"
			},
			{
				"text": "\n            Improper access control\n        ",
				"title": "Impact",
				"type": "General",
				"ordinal": "3"
			},
			{
				"text": "\n            IPS Engine version 6.158 and below (FortiOS 6.4) IPS Engine version 7.165 and below (FortiOS 7.0) IPS Engine version 7.312 and below (FortiOS 7.2)\n        ",
				"title": "Affected Products",
				"type": "General",
				"ordinal": "4"
			},
			{
				"text": "\n            IPS Engine manual download is not needed unless device is offline and cannot download IPS Engine update automatically. Fixed in IPS Engine version 6.0159 and later. FortiOS 6.4.13 and later contains IPS engine 6.0160 as the default IPS Engine. IPS Engine 6.0162 is downloadable from FortiGuard by FortiGate units with a valid subscription running FortiOS 6.4.x. Fixed in IPS Engine version 7.0166 and later. FortiOS 7.0.12 and later contains IPS engine 7.0167 as the default IPS Engine. Fixed in IPS Engine version 7.0313 and later. FortiOS 7.2.5 and later contains IPS engine 7.0314 as the default IPS Engine. IPS Engine 7.0322 is downloadable from FortiGuard by FortiGate units with a valid subscription running FortiOS 7.2.x. FortiOS 7.4.0 and later contains IPS engine 7.0493 as the default IPS Engine.\n        ",
				"title": "Solutions",
				"type": "General",
				"ordinal": "5"
			}
		]
	},
	"document_references": {},
	"acknowledgments": {
		"acknowledgment": [
			{
				"description": "Fortinet is pleased to thank DISO and Cybersecurity Lab of the University of Udine to report this vulnerability."
			}
		]
	},
	"vulnerability": {
		"ordinal": "1",
		"title": "FortiOS - IPS Engine evasion using custom TCP flags",
		"references": {
			"type": "Self",
			"reference": [
				{
					"url": "https://fortiguard.fortinet.com/psirt/FG-IR-23-090",
					"description": "FortiOS - IPS Engine evasion using custom TCP flags"
				}
			]
		},
		"cve": [
			"CVE-2023-40718"
		],
		"product_statuses": {
			"status": {
				"type": "Known Affected",
				"product_id": [
					"FortiOS-7.2.4",
					"FortiOS-7.2.3",
					"FortiOS-7.2.2",
					"FortiOS-7.2.1",
					"FortiOS-7.2.0",
					"FortiOS-7.0.11",
					"FortiOS-7.0.10",
					"FortiOS-7.0.9",
					"FortiOS-7.0.8",
					"FortiOS-7.0.7",
					"FortiOS-7.0.6",
					"FortiOS-7.0.5",
					"FortiOS-7.0.4",
					"FortiOS-7.0.3",
					"FortiOS-7.0.2",
					"FortiOS-6.4.12",
					"FortiOS-6.4.11",
					"FortiOS-6.4.10",
					"FortiOS-6.4.9",
					"FortiOS-6.4.8",
					"FortiOS-6.4.7",
					"FortiOS-6.4.6",
					"FortiOS-6.4.5",
					"FortiOS-6.4.4",
					"FortiOS-6.4.3",
					"FortiOS-6.4.2",
					"FortiOS-6.4.1",
					"FortiOS-6.4.0",
					"IPS Engine-7.321",
					"IPS Engine-7.166",
					"IPS Engine-6.158"
				]
			}
		},
		"cvss_scoresets": {
			"scoreset_v3": {
				"base_score_v3": "6.7",
				"vector_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N/E:F/RL:O/RC:R"
			}
		}
	},
	"product_tree": {
		"branch": {
			"name": "Fortinet",
			"type": "Vendor",
			"branch": [
				{
					"name": "FortiOS",
					"type": "Product Name",
					"branch": [
						{
							"name": "7.2.4",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.2.4",
								"product_id": "FortiOS-7.2.4"
							}
						},
						{
							"name": "7.2.3",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.2.3",
								"product_id": "FortiOS-7.2.3"
							}
						},
						{
							"name": "7.2.2",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.2.2",
								"product_id": "FortiOS-7.2.2"
							}
						},
						{
							"name": "7.2.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.2.1",
								"product_id": "FortiOS-7.2.1"
							}
						},
						{
							"name": "7.2.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.2.0",
								"product_id": "FortiOS-7.2.0"
							}
						},
						{
							"name": "7.0.11",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.0.11",
								"product_id": "FortiOS-7.0.11"
							}
						},
						{
							"name": "7.0.10",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.0.10",
								"product_id": "FortiOS-7.0.10"
							}
						},
						{
							"name": "7.0.9",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.0.9",
								"product_id": "FortiOS-7.0.9"
							}
						},
						{
							"name": "7.0.8",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.0.8",
								"product_id": "FortiOS-7.0.8"
							}
						},
						{
							"name": "7.0.7",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.0.7",
								"product_id": "FortiOS-7.0.7"
							}
						},
						{
							"name": "7.0.6",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.0.6",
								"product_id": "FortiOS-7.0.6"
							}
						},
						{
							"name": "7.0.5",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.0.5",
								"product_id": "FortiOS-7.0.5"
							}
						},
						{
							"name": "7.0.4",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.0.4",
								"product_id": "FortiOS-7.0.4"
							}
						},
						{
							"name": "7.0.3",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.0.3",
								"product_id": "FortiOS-7.0.3"
							}
						},
						{
							"name": "7.0.2",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 7.0.2",
								"product_id": "FortiOS-7.0.2"
							}
						},
						{
							"name": "6.4.12",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.12",
								"product_id": "FortiOS-6.4.12"
							}
						},
						{
							"name": "6.4.11",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.11",
								"product_id": "FortiOS-6.4.11"
							}
						},
						{
							"name": "6.4.10",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.10",
								"product_id": "FortiOS-6.4.10"
							}
						},
						{
							"name": "6.4.9",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.9",
								"product_id": "FortiOS-6.4.9"
							}
						},
						{
							"name": "6.4.8",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.8",
								"product_id": "FortiOS-6.4.8"
							}
						},
						{
							"name": "6.4.7",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.7",
								"product_id": "FortiOS-6.4.7"
							}
						},
						{
							"name": "6.4.6",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.6",
								"product_id": "FortiOS-6.4.6"
							}
						},
						{
							"name": "6.4.5",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.5",
								"product_id": "FortiOS-6.4.5"
							}
						},
						{
							"name": "6.4.4",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.4",
								"product_id": "FortiOS-6.4.4"
							}
						},
						{
							"name": "6.4.3",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.3",
								"product_id": "FortiOS-6.4.3"
							}
						},
						{
							"name": "6.4.2",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.2",
								"product_id": "FortiOS-6.4.2"
							}
						},
						{
							"name": "6.4.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.1",
								"product_id": "FortiOS-6.4.1"
							}
						},
						{
							"name": "6.4.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 6.4.0",
								"product_id": "FortiOS-6.4.0"
							}
						}
					]
				},
				{
					"name": "IPS Engine",
					"type": "Product Name",
					"branch": [
						{
							"name": "7.321",
							"type": "Product Version",
							"full_product_name": {
								"text": "IPS Engine 7.321",
								"product_id": "IPS Engine-7.321"
							}
						},
						{
							"name": "7.166",
							"type": "Product Version",
							"full_product_name": {
								"text": "IPS Engine 7.166",
								"product_id": "IPS Engine-7.166"
							}
						},
						{
							"name": "6.158",
							"type": "Product Version",
							"full_product_name": {
								"text": "IPS Engine 6.158",
								"product_id": "IPS Engine-6.158"
							}
						}
					]
				}
			]
		}
	}
}
