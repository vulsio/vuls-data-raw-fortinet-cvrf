{
	"document_title": "FortiOS flow-mode detection bypass under certain conditions",
	"document_type": "Fortinet PSIRT Advisories",
	"documentpublisher": {
		"type": "Vendor",
		"contact_details": "\n            Fortinet PSIRT Contact:\n            Website: https://fortiguard.fortinet.com/faq/psirt-contact\n        "
	},
	"documenttracking": {
		"identification": {
			"id": "FG-IR-16-088"
		},
		"status": "Final",
		"version": "1",
		"revisionhistory": {
			"revision": {
				"number": "1",
				"date": "2016-11-22T00:00:00",
				"description": "Current version"
			}
		},
		"initial_release_date": "2016-11-22T00:00:00",
		"current_release_date": "2016-11-22T00:00:00"
	},
	"documentnotes": {
		"note": [
			{
				"text": "\n            A FortiGate configured to use flow-based protection will stop monitoring network sessions that are active when a scanning engine is reloadedÂ after an update (nearly instantaneous process).This tends to impact long lived network sessions, with chances to be alive during and after an update, such as SMBv3 sessions.\n        ",
				"title": "Summary",
				"type": "Summary",
				"ordinal": "1"
			},
			{
				"text": "\n            A FortiGate configured to use flow-based protection will stop monitoring network sessions that are active when a scanning engine is reloaded after an update (nearly instantaneous process).This tends to impact long lived network sessions, with chances to be alive during and after an update, such as SMBv3 sessions.\n        ",
				"title": "Description",
				"type": "General",
				"ordinal": "2"
			},
			{
				"text": "\n            Protection bypass\n        ",
				"title": "Impact",
				"type": "General",
				"ordinal": "3"
			},
			{
				"text": "\n            FortiOS version 5.0.xFortiOS version 5.2.x\n        ",
				"title": "Affected Products",
				"type": "General",
				"ordinal": "4"
			},
			{
				"text": "\n            FortiGates in routed mode: Upgrade to FortiOS 5.4.0 or above, or stay in proxy-based protection mode (default). FortiGates in transparent mode: Upgrade to FortiOS 5.4.0 or above. For FortiOS 5.2 branch: Load FortiOS 5.2 compatible[*] IPS engine 3.299 or above. [*] Reach out to your local TAC for the compatibility support.\n        ",
				"title": "Solutions",
				"type": "General",
				"ordinal": "5"
			}
		]
	},
	"document_references": {},
	"acknowledgments": {
		"acknowledgment": [
			{
				"description": "We are pleased to thank Yves Bieri, Stefan Frei, Christof Jungo of the Swisscom securityÂ group, who discovered the issue while it was in the process of being fixed, and committed to responsible disclosure."
			}
		]
	},
	"vulnerability": {
		"ordinal": "1",
		"title": "FortiOS flow-mode detection bypass under certain conditions",
		"references": {
			"type": "Self",
			"reference": [
				{
					"url": "https://fortiguard.fortinet.com/psirt/FG-IR-16-088",
					"description": "FortiOS flow-mode detection bypass under certain conditions"
				}
			]
		},
		"cve": [
			"CVE-2016-7541"
		],
		"product_statuses": {
			"status": {
				"type": "Known Affected",
				"product_id": [
					"FortiOS-5.4.1",
					"FortiOS-5.4.0",
					"FortiOS-5.2.15",
					"FortiOS-5.2.14",
					"FortiOS-5.2.13",
					"FortiOS-5.2.12",
					"FortiOS-5.2.11",
					"FortiOS-5.2.10",
					"FortiOS-5.2.9",
					"FortiOS-5.2.8",
					"FortiOS-5.2.7",
					"FortiOS-5.2.6",
					"FortiOS-5.2.5",
					"FortiOS-5.2.4",
					"FortiOS-5.2.3",
					"FortiOS-5.2.2",
					"FortiOS-5.2.1",
					"FortiOS-5.2.0",
					"FortiOS-5.0.14",
					"FortiOS-5.0.13",
					"FortiOS-5.0.12",
					"FortiOS-5.0.11",
					"FortiOS-5.0.10",
					"FortiOS-5.0.9",
					"FortiOS-5.0.8",
					"FortiOS-5.0.7",
					"FortiOS-5.0.6",
					"FortiOS-5.0.5",
					"FortiOS-5.0.4",
					"FortiOS-5.0.3",
					"FortiOS-5.0.2",
					"FortiOS-5.0.1",
					"FortiOS-5.0.0"
				]
			}
		},
		"cvss_scoresets": {
			"scoreset_v3": {
				"base_score_v3": "4.9",
				"vector_v3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:X/RC:X"
			}
		}
	},
	"product_tree": {
		"branch": {
			"name": "Fortinet",
			"type": "Vendor",
			"branch": [
				{
					"name": "FortiOS",
					"type": "Product Name",
					"branch": [
						{
							"name": "5.4.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.4.1",
								"product_id": "FortiOS-5.4.1"
							}
						},
						{
							"name": "5.4.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.4.0",
								"product_id": "FortiOS-5.4.0"
							}
						},
						{
							"name": "5.2.15",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.15",
								"product_id": "FortiOS-5.2.15"
							}
						},
						{
							"name": "5.2.14",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.14",
								"product_id": "FortiOS-5.2.14"
							}
						},
						{
							"name": "5.2.13",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.13",
								"product_id": "FortiOS-5.2.13"
							}
						},
						{
							"name": "5.2.12",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.12",
								"product_id": "FortiOS-5.2.12"
							}
						},
						{
							"name": "5.2.11",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.11",
								"product_id": "FortiOS-5.2.11"
							}
						},
						{
							"name": "5.2.10",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.10",
								"product_id": "FortiOS-5.2.10"
							}
						},
						{
							"name": "5.2.9",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.9",
								"product_id": "FortiOS-5.2.9"
							}
						},
						{
							"name": "5.2.8",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.8",
								"product_id": "FortiOS-5.2.8"
							}
						},
						{
							"name": "5.2.7",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.7",
								"product_id": "FortiOS-5.2.7"
							}
						},
						{
							"name": "5.2.6",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.6",
								"product_id": "FortiOS-5.2.6"
							}
						},
						{
							"name": "5.2.5",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.5",
								"product_id": "FortiOS-5.2.5"
							}
						},
						{
							"name": "5.2.4",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.4",
								"product_id": "FortiOS-5.2.4"
							}
						},
						{
							"name": "5.2.3",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.3",
								"product_id": "FortiOS-5.2.3"
							}
						},
						{
							"name": "5.2.2",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.2",
								"product_id": "FortiOS-5.2.2"
							}
						},
						{
							"name": "5.2.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.1",
								"product_id": "FortiOS-5.2.1"
							}
						},
						{
							"name": "5.2.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.2.0",
								"product_id": "FortiOS-5.2.0"
							}
						},
						{
							"name": "5.0.14",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.14",
								"product_id": "FortiOS-5.0.14"
							}
						},
						{
							"name": "5.0.13",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.13",
								"product_id": "FortiOS-5.0.13"
							}
						},
						{
							"name": "5.0.12",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.12",
								"product_id": "FortiOS-5.0.12"
							}
						},
						{
							"name": "5.0.11",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.11",
								"product_id": "FortiOS-5.0.11"
							}
						},
						{
							"name": "5.0.10",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.10",
								"product_id": "FortiOS-5.0.10"
							}
						},
						{
							"name": "5.0.9",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.9",
								"product_id": "FortiOS-5.0.9"
							}
						},
						{
							"name": "5.0.8",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.8",
								"product_id": "FortiOS-5.0.8"
							}
						},
						{
							"name": "5.0.7",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.7",
								"product_id": "FortiOS-5.0.7"
							}
						},
						{
							"name": "5.0.6",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.6",
								"product_id": "FortiOS-5.0.6"
							}
						},
						{
							"name": "5.0.5",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.5",
								"product_id": "FortiOS-5.0.5"
							}
						},
						{
							"name": "5.0.4",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.4",
								"product_id": "FortiOS-5.0.4"
							}
						},
						{
							"name": "5.0.3",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.3",
								"product_id": "FortiOS-5.0.3"
							}
						},
						{
							"name": "5.0.2",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.2",
								"product_id": "FortiOS-5.0.2"
							}
						},
						{
							"name": "5.0.1",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.1",
								"product_id": "FortiOS-5.0.1"
							}
						},
						{
							"name": "5.0.0",
							"type": "Product Version",
							"full_product_name": {
								"text": "FortiOS 5.0.0",
								"product_id": "FortiOS-5.0.0"
							}
						}
					]
				}
			]
		}
	}
}
